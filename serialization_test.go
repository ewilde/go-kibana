package kibana

import (
	"encoding/json"
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestSerialization(t *testing.T) {
	body := `{
  "took": 2,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "failed": 0
  },
  "hits": {
    "total": 1,
    "max_score": 1,
    "hits": [
      {
        "_index": "logzioCustomerKibanaIndex",
        "_type": "index-pattern",
        "_id": "[logzioCustomerIndex]YYMMDD",
        "_score": 1,
        "_source": {
          "title": "[logzioCustomerIndex]YYMMDD",
          "timeFieldName": "@timestamp",
          "intervalName": "days",
          "fields": "[{\"type\":\"string\",\"name\":\"stack\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"upstream_url\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"source_gateway\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"_logzio_logceptions\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"system.filesystem.device_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.container.size.rw\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"patch\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"loadbalancer\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.5.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.info.id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.actual.free\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"boolean\",\"name\":\"logzio-event-muted\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"X-B3-TraceId\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.info.containers.paused\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"host_hostname\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.fsstat.total_size.free\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.8.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"module\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.free\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.swap.free\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.actual.used.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.1.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"tags\",\"analyzed\":true,\"aggregatable\":false,\"count\":0,\"indexed\":true,\"doc_values\":false},{\"type\":\"string\",\"name\":\"beat.name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"kong-api-key\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"filename\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.memory.usage.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"level_value\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.real_region_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.user.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"system.network.name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"stack_trace\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.status\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"device\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.10.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.memory.usage.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.diskio.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"backend_ip\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.diskio.writes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"logzio_codec\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.created\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.9.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.in.dropped\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.14.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.9.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"host_type\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"transaction_duration\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"index-failed-reason\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.country_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"request_parameters.sortCode\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"currency\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"backend_processing_time\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"timestamp\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.load.1\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"host_ip\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.3.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.total.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.load.5\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.10.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"logzio-alert\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"response_processing_time\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.container.size.root_fs\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.in.errors\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"correlation_id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.timezone\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.filesystem.files\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"ssl_cipher\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.4.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.system.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.load.norm.15\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.12.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.iowait.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.com_amazonaws_ecs_container-name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"client_ip\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"geoip.longitude\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.4.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"root-user-id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"service_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.steal.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"X-B3-ParentSpanId\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.region_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"metricset.module\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"metricset.rtt\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"os_patch\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.Vendor\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.filesystem.used.bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"uris\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.fsstat.total_files\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"thread_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"logzio-alert-title\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.memory.usage.max\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"TraceId\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.com_amazonaws_ecs_task-arn\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.filesystem.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"logzio-hits\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.org_label-schema_vcs-ref\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"response_code\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.diskio.reads\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.com_amazonaws_ecs_task-definition-family\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"lozgio-time-range-in-minutes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.load.15\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"fluentd_tags\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"request_parameters.addressUid\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"geoip.dma_code\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.cores\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"metricset.host\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.country_code2\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.6.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.softirq.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.filesystem.free_files\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.8.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"_logzio_insights\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.load.norm.5\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"beat.version\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.load.norm.1\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.11.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.swap.used.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"X-Span-Export\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.idle.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.info.containers.running\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"event_category\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"message\",\"analyzed\":true,\"aggregatable\":false,\"count\":0,\"indexed\":true,\"doc_values\":false},{\"type\":\"string\",\"name\":\"threadName\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"beat.hostname\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"jwt-private-key\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"environment\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"lineno\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"HOSTNAME\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.filesystem.free\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.fsstat.total_size.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.7.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.11.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"received_bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.org_label-schema_build-date\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"system.filesystem.mount_point\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.info.containers.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.3.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"response_body\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"type\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.0.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"event_type\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"backend_status_code\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"root-user-client-secret\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"logzio-alert-description\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"target_gateway\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.Description\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"jwt-public-key\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"root-user-client-id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"logzio-alert-definition-id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"verb\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.memory.rss.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.5.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"request_processing_time\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"request_parameters.accountNumber\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.command\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"@metadata.type\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.13.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.actual.used.bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"geoip.latitude\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"request_parameters.accountUid\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.filesystem.available\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.used.bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"status\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.system.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.irq.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.in.bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.ip\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.12.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.org_label-schema_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.0.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.14.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"funcName\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.memory.rss.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.fsstat.count\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"elb_status_code\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.cpu.nice.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.org_label-schema_docker_dockerfile\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.info.images\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.user.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"userAgent\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.city_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"date\",\"name\":\"@timestamp\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.7.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"X-B3-SpanId\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"logzio-alert-triggered-severity\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"os_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.image\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.memory.limit\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.com_amazonaws_ecs_cluster\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.used.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"minor\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"http_protocol\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.filesystem.used.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"jwt-public-der\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"organisation_id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.kernel.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"major\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.out.dropped\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.info.containers.stopped\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.memory.fail.count\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"tag\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"logger_name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"ssl_protocol\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.out.packets\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.Version\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.org_label-schema_vcs-url\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"level\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"@metadata.beat\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.org_label-schema_vcs-type\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.in.packets\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.continent_code\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.com_amazonaws_ecs_task-definition-version\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.2.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"request\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.2.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.out.errors\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"os_minor\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"os_major\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.swap.total\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"backend_port\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"sent_bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.user.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"client_port\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.kernel.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"geo_point\",\"name\":\"geoip.location\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"@version\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.fsstat.total_size.used\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.maintainer\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.13.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.6.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"process\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"amount\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"os\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"docker.container.labels.org_label-schema_license\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.network.out.bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.system.pct\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"host_instance_id\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"system.memory.swap.used.bytes\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"docker.cpu.core.1.ticks\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"geoip.postal_code\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"string\",\"name\":\"metricset.name\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true},{\"type\":\"number\",\"name\":\"httpversion\",\"analyzed\":false,\"aggregatable\":true,\"count\":0,\"indexed\":true,\"doc_values\":true}]"
        }
      }
    ]
  }
}`
	response := &savedObjectSearchResponse553{}
	err := json.Unmarshal([]byte(body), response)
	assert.Nil(t, err, "could not parse saved objects response, error: %v, response body: %s", err, body)

	source := response.Hits.Hits[0].Source
	assert.NotNil(t, source)
	assert.Equal(t, "[logzioCustomerIndex]YYMMDD", source["title"])
}
